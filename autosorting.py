import win32com.client
import time

chart = []

stock_list = ['A005930', 'A000660', 'A035420', 'A207940', 'A035720', 'A005935', 'A051910', 'A006400', 'A005380', 'A323410', 'A000270', 'A377300', 'A068270', 'A259960', 'A005490', 'A105560', 'A012330', 'A302440', 'A028260', 'A066570', 'A096770', 'A055550', 'A034730', 'A051900', 'A036570', 'A352820', 'A015760', 'A003550', 'A009150', 'A017670', 'A032830', 'A086790', 'A011200', 'A003670', 'A361610', 'A018260', 'A033780', 'A402340', 'A034020', 'A251270', 'A000810', 'A090430', 'A329180', 'A010130', 'A010950', 'A316140', 'A003490', 'A030200', 'A024110', 'A011790', 'A326030', 'A034220', 'A018880', 'A011070', 'A011170', 'A009540', 'A383220', 'A020150', 'A009830', 'A032640', 'A137310', 'A088980', 'A086280', 'A006800', 'A097950', 'A021240', 'A004020', 'A000720', 'A035250', 'A011780', 'A161390', 'A138040', 'A010140', 'A071050', 'A267250', 'A028050', 'A139480', 'A000100', 'A271560', 'A016360', 'A029780', 'A005830', 'A003410', 'A000060', 'A005940', 'A241560', 'A078930', 'A008930', 'A002790', 'A014680', 'A180640', 'A005387', 'A008560', 'A036460', 'A000990', 'A026960', 'A052690', 'A006360', 'A336260', 'A307950', 'A004990', 'A128940', 'A007070', 'A336370', 'A000120', 'A010620', 'A028670', 'A012750', 'A008770', 'A047810', 'A272210', 'A298050', 'A138930', 'A039490', 'A010060', 'A204320', 'A051915', 'A006280', 'A088350', 'A285130', 'A030000', 'A282330', 'A042660', 'A002380', 'A023530', 'A112610', 'A047050', 'A001040', 'A000880', 'A047040', 'A012510', 'A005385', 'A093370', 'A298020', 'A375500', 'A271940', 'A001450', 'A064350', 'A012450', 'A000080', 'A004170', 'A081660', 'A004000', 'A009240', 'A120110', 'A004800', 'A011210', 'A003090', 'A000150', 'A019170', 'A051600', 'A181710', 'A004370', 'A111770', 'A950210', 'A017800', 'A007310', 'A006260', 'A042700', 'A069620', 'A010120', 'A069960', 'A175330', 'A005850', 'A001440', 'A014820', 'A381970', 'A139130', 'A178920', 'A007700', 'A000240', 'A294870', 'A009900', 'A001230', 'A089860', 'A011000', 'A300720', 'A330590', 'A020560', 'A005070', 'A010780', 'A051905', 'A185750', 'A005300', 'A013890', 'A000210', 'A248070', 'A001740', 'A005250', 'A079550', 'A000670', 'A073240', 'A003530', 'A003690', 'A032350', 'A082640', 'A018670', 'A006650', 'A004490', 'A192820', 'A003240', 'A268280', 'A192080', 'A214320', 'A009420', 'A031430', 'A066575', 'A353200', 'A023590', 'A002840', 'A016380', 'A003850', 'A363280', 'A003540', 'A001800', 'A036420', 'A039130', 'A395400', 'A365550', 'A015350', 'A001120', 'A241590', 'A069260', 'A020000', 'A014830', 'A348950', 'A003000', 'A161890', 'A006120', 'A284740', 'A079160', 'A344820', 'A272450', 'A089590', 'A103140', 'A298000', 'A097520', 'A000070', 'A034120', 'A009450', 'A267260', 'A105630', 'A005440', 'A010050', 'A017390', 'A003470', 'A006040', 'A005690', 'A195870', 'A033270', 'A003520', 'A001680', 'A102460', 'A003580', 'A005880', 'A114090', 'A057050', 'A267270', 'A280360', 'A049770', 'A000640', 'A085620', 'A001530', 'A016710', 'A090435', 'A025540', 'A003280', 'A026890', 'A383800', 'A001430', 'A00680K', 'A192400', 'A002350', 'A005090', 'A097230', 'A192650', 'A210980', 'A145990', 'A064960', 'A034830', 'A009970', 'A007340', 'A003230', 'A034310', 'A017810', 'A042670', 'A145720', 'A012630', 'A005610', 'A170900', 'A298040', 'A001880', 'A001820', 'A071840', 'A006390', 'A003070', 'A286940', 'A006405', 'A000815', 'A008730', 'A030610', 'A115390', 'A007810', 'A001720', 'A037270', 'A007570', 'A025860', 'A000400', 'A123890', 'A005180', 'A161000', 'A108670', 'A020120', 'A018250', 'A093050', 'A281820', 'A027410', 'A007690', 'A126560', 'A139990', 'A001060', 'A271980', 'A060980', 'A138490', 'A068400', 'A008490', 'A002310', 'A001510', 'A357120', 'A081000', 'A092220', 'A003545', 'A094800', 'A004430', 'A005390', 'A183190', 'A037560', 'A002240', 'A071320', 'A138250', 'A002320', 'A017960', 'A214330', 'A000370', 'A053210', 'A249420', 'A058650', 'A005950', 'A003030', 'A001390', 'A293940', 'A298690', 'A339770', 'A003620', 'A002270', 'A009160', 'A001725', 'A005420', 'A016800', 'A130660', 'A055490', 'A002990', 'A011930', 'A001500', 'A071055', 'A226320', 'A009410', 'A000020', 'A088260', 'A002020', 'A030210', 'A033180', 'A00088K', 'A001630', 'A006490', 'A084010', 'A082740', 'A000050', 'A003300', 'A011690', 'A122900', 'A095720', 'A009290', 'A024720', 'A004690', 'A004700', 'A002960', 'A005500', 'A003060', 'A900140', 'A001200', 'A072710', 'A104700', 'A293480', 'A004890', 'A377190', 'A317400', 'A068290', 'A033240', 'A024090', 'A011785', 'A001520', 'A107590', 'A006110', 'A084690', 'A003220', 'A009680', 'A007660', 'A029530', 'A091810', 'A016590', 'A001360', 'A000480', 'A058430', 'A019680', 'A017940', 'A213500', 'A005960', 'A272550', 'A007460', 'A006060', 'A011280', 'A075580', 'A016580', 'A093230', 'A035510', 'A013360', 'A003920', 'A013580', 'A014160', 'A002390', 'A031440', 'A001780', 'A001470', 'A002780', 'A079430', 'A000140', 'A007860', 'A001790', 'A003570', 'A084680', 'A000155', 'A00104K', 'A016610', 'A029460', 'A010690', 'A016450', 'A005810', 'A037710', 'A009155', 'A079980', 'A036530', 'A001460', 'A194370', 'A008350', 'A077500', 'A092230', 'A001940', 'A002030', 'A004980', 'A002810', 'A015860', 'A006840', 'A306200', 'A044450', 'A025000', 'A002620', 'A012610', 'A095570', 'A002150', 'A101060', 'A009810', 'A008060', 'A033530', 'A004830', 'A001130', 'A001270', 'A002900', 'A372910', 'A005720', 'A00279K', 'A136490', 'A003160', 'A009270', 'A011500', 'A001070', 'A009580', 'A102260', 'A001570', 'A001340', 'A097955', 'A003200', 'A004250', 'A000390', 'A229640', 'A004380', 'A070960', 'A096760', 'A000430', 'A005945', 'A094280', 'A014280', 'A234080', 'A033920', 'A101530', 'A000540', 'A003960', 'A400760', 'A023450', 'A003560', 'A004560', 'A000680', 'A000490', 'A101140', 'A322000', 'A010955', 'A023800', 'A005389', 'A018470', 'A007210', 'A015360', 'A004360', 'A102280', 'A244920', 'A002210', 'A007160', 'A083420', 'A005680', 'A004970', 'A011760', 'A002100', 'A063160', 'A036580', 'A077970', 'A214390', 'A117580', 'A090350', 'A100250', 'A009470', 'A000970', 'A069460', 'A33626K', 'A012030', 'A015890', 'A039570', 'A028100', 'A004710', 'A014790', 'A248170', 'A003120', 'A001750', 'A308170', 'A33637K', 'A003555', 'A001250', 'A004960', 'A128820', 'A035150', 'A103590', 'A200880', 'A017900', 'A267850', 'A008700', 'A006220', 'A089470', 'A091090', 'A009070', 'A002170', 'A282690', 'A000300', 'A28513K', 'A134380', 'A168490', 'A003547', 'A003830', 'A004310', 'A000230', 'A078520', 'A105840', 'A004720', 'A013570', 'A007110', 'A02826K', 'A092200', 'A074610', 'A006740', 'A012800', 'A000320', 'A002710', 'A017180', 'A003460', 'A096775', 'A024890', 'A000180', 'A002410', 'A006380', 'A000700', 'A004540', 'A007280', 'A008040', 'A002450', 'A004140', 'A004080', 'A002880', 'A011090', 'A37550K', 'A009190', 'A004150', 'A002700', 'A008970', 'A002460', 'A016880', 'A012690', 'A000860', 'A123690', 'A334890', 'A003650', 'A006890', 'A017550', 'A210540', 'A002630', 'A100840', 'A010040', 'A019440', 'A004090', 'A006660', 'A014580', 'A044820', 'A015020', 'A025750', 'A032560', 'A004060', 'A012200', 'A005320', 'A023000', 'A001045', 'A005430', 'A011150', 'A267290', 'A008250', 'A120030', 'A071970', 'A047400', 'A016740', 'A014530', 'A034300', 'A011700', 'A03473K', 'A092440', 'A067830', 'A005740', 'A009460', 'A034590', 'A010960', 'A053690', 'A000890', 'A005750', 'A006340', 'A003350', 'A001260', 'A012170', 'A134790', 'A118000', 'A002760', 'A002600', 'A009320', 'A007540', 'A023810', 'A000220', 'A264900', 'A003480', 'A025820', 'A004270', 'A013870', 'A003610', 'A152550', 'A004410', 'A004440', 'A011810', 'A035000', 'A227840', 'A013520', 'A350520', 'A008600', 'A009180', 'A015590', 'A001140', 'A015230', 'A119650', 'A005010', 'A031820', 'A017040', 'A380440', 'A078000', 'A007980', 'A001290', 'A143210', 'A011390', 'A006370', 'A004910', 'A004770', 'A000910', 'A001550', 'A075180', 'A214420', 'A058850', 'A012160', 'A002795', 'A378850', 'A005800', 'A009200', 'A100220', 'A090080', 'A357250', 'A163560', 'A010580', 'A002200', 'A002360', 'A024900', 'A002720', 'A004840', 'A006200', 'A093240', 'A027970', 'A003780', 'A005870', 'A000500', 'A000520', 'A009440', 'A010820', 'A129260', 'A120115', 'A016090', 'A007590', 'A111110', 'A023960', 'A010600', 'A020760', 'A003720', 'A000157', 'A014440', 'A000650', 'A013700', 'A008260', 'A019175', 'A011330', 'A021050', 'A338100', 'A004450', 'A001080', 'A001560', 'A014710', 'A015540', 'A049800', 'A002070', 'A000040', 'A006090', 'A155660', 'A006980', 'A092780', 'A058860', 'A133820', 'A012320', 'A041650', 'A021820', 'A008110', 'A000725', 'A012280', 'A005360', 'A002920', 'A058730', 'A025890', 'A002870', 'A085310', 'A003080', 'A026940', 'A006805', 'A014990', 'A010100', 'A011420', 'A008420', 'A145210', 'A072130', 'A017370', 'A001380', 'A000850', 'A023150', 'A023350', 'A004870', 'A019180', 'A002140', 'A002220', 'A001620', 'A005110', 'A025620', 'A000105', 'A001275', 'A000590', 'A003010', 'A014130', 'A009770', 'A145270', 'A109070', 'A010770', 'A000950', 'A069730', 'A003535', 'A123700', 'A008870', 'A044380', 'A007610', 'A009310', 'A078935', 'A007120', 'A090370', 'A001020', 'A000215', 'A006880', 'A001210', 'A002820', 'A027740', 'A025560', 'A019685', 'A007630', 'A33626L', 'A002690', 'A008775', 'A069640', 'A005305', 'A010660', 'A071090', 'A024070', 'A003475', 'A010400', 'A051630', 'A084670', 'A013000', 'A025530', 'A33637L', 'A005257', 'A006570', 'A004100', 'A003465', 'A006125', 'A015260', 'A00499K', 'A014910', 'A084870', 'A155900', 'A010640', 'A011300', 'A009140', 'A005820', 'A030720', 'A000760', 'A011230', 'A018500', 'A033250', 'A003495', 'A030790', 'A153360', 'A001420', 'A009835', 'A140910', 'A004920', 'A010420', 'A001465', 'A003925', 'A003680', 'A005030', 'A172580', 'A088790', 'A019490', 'A012600', 'A071950', 'A008500', 'A204210', 'A001770', 'A35320K', 'A108675', 'A36328K', 'A004365', 'A010145', 'A004835', 'A002420', 'A007815', 'A001685', 'A096300', 'A000087', 'A002025', 'A002355', 'A000075', 'A001795', 'A38380K', 'A000225', 'A18064K', 'A004255', 'A000885', 'A001515', 'A145995', 'A009415', 'A005725', 'A00806K', 'A000995', 'A007575', 'A004985', 'A001755', 'A084695', 'A001745', 'A26490K', 'A090355', 'A012205', 'A002995', 'A004415', 'A003075', 'A014825', 'A004105', 'A004565', 'A004545', 'A011155', 'A00781K', 'A006345', 'A005745', 'A014285', 'A000145', 'A005965', 'A000325', 'A008355', 'A001065', 'A000545', 'A000227', 'A001067', 'A002785', 'A014915', 'A016385', 'A001525', 'A002787', 'A001527', 'A000547', 'A009275', 'A001529']

def stock(code):
    # Create Object
    instMarketEye = win32com.client.Dispatch("CpSysDib.MarketEye")
    
    instCpMarketWatch = win32com.client.Dispatch("CpSysDib.CpMarketWatch")


    # SetInputValue
    instMarketEye.SetInputValue(0, (4, 67, 70, 77, 111))
    instMarketEye.SetInputValue(1, code)
    
    instCpMarketWatch.SetInputValue(0, code)
    instCpMarketWatch.SetInputValue(1, 58)
    instCpMarketWatch.SetInputValue(2, 0)


    # BlockRequest
    instMarketEye.BlockRequest()
    
    instCpMarketWatch.BlockRequest()

    #현재가
    price_now = instMarketEye.GetDataValue(0, 0)
    per = instMarketEye.GetDataValue(1, 0)
    eps=instMarketEye.GetDataValue(2, 0)
    
    Roe = instMarketEye.GetDataValue(3, 0)
    #최근분기년월
    last_year_month = instMarketEye.GetDataValue(4, 0)


    Golden_Cross = instCpMarketWatch.GetDataValue(0, 0)
    
    #value = [price_now,per,eps, Roe, last_year_month]
    #Roe > 15 and 5 < per < 20 and
    if Roe > 15 and 5 < per < 10: 
        chart.append(code)
    return chart


for i in stock_list:
    stock(i)
    time.sleep(0.4)
    print(i)
    print(chart)

'''
def cross():
    
import pandas as pd
df = pd.DataFrame(chart, columns=['price_now','per','eps', 'Roe', 'last_year_month'])
df.to_excel('chart.xlsx', index=False) 
'''